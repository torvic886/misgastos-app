<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/17"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.misgastos.controller.GestionUsuariosController"
            style="-fx-background-color: #f1f5f9;">

    <padding>
        <Insets top="15" right="15" bottom="15" left="15"/>
    </padding>

    <!-- PANEL IZQUIERDO: FORMULARIO -->
    <left>
        <ScrollPane fitToWidth="true" style="-fx-background-color: transparent; -fx-background: transparent;">
            <VBox spacing="10" 
                  prefWidth="320" maxWidth="320"
                  style="-fx-background-color: white; -fx-background-radius: 12; -fx-padding: 16; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.12), 15, 0, 0, 3); -fx-border-color: #cbd5e1; -fx-border-width: 1.5; -fx-border-radius: 12;">
                
                <VBox.margin>
                    <Insets right="12"/>
                </VBox.margin>

            <!-- Header del formulario -->
            <HBox alignment="CENTER_LEFT" spacing="10">
                <Label text="ðŸ‘¤" style="-fx-font-size: 22px;"/>
                <VBox spacing="1">
                    <Label text="GestiÃ³n de Usuarios" 
                           style="-fx-font-weight: bold; -fx-font-size: 15px; -fx-text-fill: #1e293b;"/>
                    <Label text="Administra usuarios del sistema" 
                           style="-fx-font-size: 11px; -fx-text-fill: #64748b;"/>
                </VBox>
            </HBox>

            <Separator style="-fx-background-color: #e2e8f0;"/>

            <!-- Username -->
            <VBox spacing="5">
                <Label text="Usuario:" 
                       style="-fx-font-size: 11px; -fx-font-weight: 600; -fx-text-fill: #334155;"/>
                <TextField fx:id="txtUsername" 
                           promptText="Nombre de usuario"
                           style="-fx-background-color: white; -fx-border-color: #cbd5e1; -fx-border-width: 1; -fx-border-radius: 6; -fx-background-radius: 6; -fx-padding: 6 8; -fx-font-size: 12px;"/>
            </VBox>

            <!-- ContraseÃ±a -->
            <VBox spacing="5">
                <Label text="ContraseÃ±a:" 
                       style="-fx-font-size: 11px; -fx-font-weight: 600; -fx-text-fill: #334155;"/>
                <PasswordField fx:id="txtPassword" 
                               promptText="ContraseÃ±a"
                               style="-fx-background-color: white; -fx-border-color: #cbd5e1; -fx-border-width: 1; -fx-border-radius: 6; -fx-background-radius: 6; -fx-padding: 6 8; -fx-font-size: 12px;"/>
            </VBox>

            <!-- Rol -->
            <VBox spacing="5">
                <Label text="Rol:" 
                       style="-fx-font-size: 11px; -fx-font-weight: 600; -fx-text-fill: #334155;"/>
                <ComboBox fx:id="cmbRol" 
                          maxWidth="Infinity"
                          promptText="Seleccione rol"
                          style="-fx-background-color: white; -fx-border-color: #cbd5e1; -fx-border-width: 1; -fx-border-radius: 6; -fx-background-radius: 6; -fx-padding: 5;"/>
            </VBox>

            <!-- Usuario Activo -->
            <HBox spacing="8" alignment="CENTER_LEFT" 
                  style="-fx-background-color: #f8fafc; -fx-padding: 8 10; -fx-background-radius: 6; -fx-border-color: #e2e8f0; -fx-border-width: 1; -fx-border-radius: 6;">
                <CheckBox fx:id="chkActivo" 
                          selected="true"
                          style="-fx-font-size: 12px;"/>
                <Label text="Usuario activo" 
                       style="-fx-font-size: 12px; -fx-text-fill: #475569; -fx-font-weight: 500;"/>
            </HBox>

            <Separator style="-fx-background-color: #e2e8f0;"/>

            <!-- Botones de acciÃ³n -->
            <VBox spacing="8">
                <!-- Crear Usuario -->
                <Button text="âœ“ Crear Usuario" 
                        onAction="#handleCrear"
                        maxWidth="Infinity"
                        prefHeight="34"
                        style="-fx-background-color: #2563eb; -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 12px; -fx-background-radius: 6; -fx-cursor: hand;"/>

                <!-- Guardar Cambios -->
                <Button text="ðŸ’¾ Guardar Cambios" 
                        onAction="#handleActualizar"
                        maxWidth="Infinity"
                        prefHeight="32"
                        style="-fx-background-color: #059669; -fx-text-fill: white; -fx-font-weight: 600; -fx-font-size: 11px; -fx-background-radius: 6; -fx-cursor: hand;"/>

                <!-- Cambiar ContraseÃ±a -->
                <Button text="ðŸ”‘ Cambiar ContraseÃ±a" 
                        onAction="#handleCambiarPassword"
                        maxWidth="Infinity"
                        prefHeight="32"
                        style="-fx-background-color: #d97706; -fx-text-fill: white; -fx-font-weight: 600; -fx-font-size: 11px; -fx-background-radius: 6; -fx-cursor: hand;"/>

                <!-- Eliminar Usuario -->
                <Button text="âœ• Eliminar Usuario" 
                        onAction="#handleEliminar"
                        maxWidth="Infinity"
                        prefHeight="32"
                        style="-fx-background-color: #dc2626; -fx-text-fill: white; -fx-font-weight: 600; -fx-font-size: 11px; -fx-background-radius: 6; -fx-cursor: hand;"/>

                <Separator style="-fx-background-color: #e2e8f0;"/>

                <!-- Limpiar Formulario -->
                <Button text="âŸ² Limpiar Formulario" 
                        onAction="#handleLimpiar"
                        maxWidth="Infinity"
                        prefHeight="30"
                        style="-fx-background-color: #64748b; -fx-text-fill: white; -fx-font-weight: 600; -fx-font-size: 11px; -fx-background-radius: 6; -fx-cursor: hand;"/>
            </VBox>

            <Separator style="-fx-background-color: #e2e8f0;"/>

            <!-- Panel de informaciÃ³n adicional -->
            <VBox spacing="8" style="-fx-background-color: #f0f9ff; -fx-padding: 12; -fx-background-radius: 8; -fx-border-color: #bae6fd; -fx-border-width: 1; -fx-border-radius: 8;">
                <Label text="â„¹ï¸ InformaciÃ³n" 
                       style="-fx-font-size: 12px; -fx-font-weight: bold; -fx-text-fill: #0369a1;"/>
                
                <VBox spacing="4">
                    <Label text="â€¢ Al crear un usuario, asigne un rol apropiado" 
                           style="-fx-font-size: 10px; -fx-text-fill: #475569; -fx-wrap-text: true;"/>
                    <Label text="â€¢ Las contraseÃ±as deben ser seguras" 
                           style="-fx-font-size: 10px; -fx-text-fill: #475569; -fx-wrap-text: true;"/>
                    <Label text="â€¢ Usuarios inactivos no pueden ingresar" 
                           style="-fx-font-size: 10px; -fx-text-fill: #475569; -fx-wrap-text: true;"/>
                </VBox>
            </VBox>

        </VBox>
        </ScrollPane>
    </left>

    <!-- PANEL DERECHO: TABLA DE USUARIOS -->
    <center>
        <VBox spacing="12" 
              style="-fx-background-color: white; -fx-background-radius: 12; -fx-padding: 16; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.12), 15, 0, 0, 3); -fx-border-color: #cbd5e1; -fx-border-width: 1.5; -fx-border-radius: 12;">

            <!-- Header de la tabla -->
            <HBox alignment="CENTER_LEFT" spacing="10">
                <HBox alignment="CENTER_LEFT" spacing="10" HBox.hgrow="ALWAYS">
                    <Label text="ðŸ“‹" style="-fx-font-size: 20px;"/>
                    <VBox spacing="1">
                        <Label text="Lista de Usuarios" 
                               style="-fx-font-size: 15px; -fx-font-weight: bold; -fx-text-fill: #1e293b;"/>
                        <Label text="Visualiza y gestiona usuarios" 
                               style="-fx-font-size: 11px; -fx-text-fill: #64748b;"/>
                    </VBox>
                </HBox>
                
                <Button text="ðŸ”„ Actualizar" 
                        onAction="#handleRefrescar"
                        style="-fx-background-color: #e0e7ff; -fx-text-fill: #4f46e5; -fx-font-weight: 600; -fx-padding: 6 12; -fx-background-radius: 6; -fx-cursor: hand; -fx-font-size: 11px;"/>
            </HBox>

            <Separator style="-fx-background-color: #e2e8f0;"/>

            <!-- Tabla -->
            <TableView fx:id="tblUsuarios" VBox.vgrow="ALWAYS"
                       style="-fx-background-color: transparent; -fx-background-radius: 8; -fx-border-color: #e2e8f0; -fx-border-width: 1; -fx-border-radius: 8;">
                <columns>
                    <TableColumn fx:id="colId" text="ID" prefWidth="60" 
                                 style="-fx-alignment: CENTER;"/>
                    <TableColumn fx:id="colUsername" text="Usuario" prefWidth="160"/>
                    <TableColumn fx:id="colRol" text="Rol" prefWidth="130"/>
                    <TableColumn fx:id="colActivo" text="Estado" prefWidth="90" 
                                 style="-fx-alignment: CENTER;"/>
                    <TableColumn fx:id="colFechaCreacion" text="Fecha CreaciÃ³n" prefWidth="150"/>
                </columns>
            </TableView>

            <!-- Footer con totales -->
            <HBox spacing="8" alignment="CENTER" 
                  style="-fx-background-color: linear-gradient(to right, #f8fafc, #f1f5f9); -fx-padding: 10; -fx-background-radius: 8; -fx-border-color: #e2e8f0; -fx-border-width: 1; -fx-border-radius: 8;">
                
                <HBox spacing="6" alignment="CENTER">
                    <Label text="ðŸ‘¥" style="-fx-font-size: 16px;"/>
                    <Label text="Total:" 
                           style="-fx-font-size: 12px; -fx-text-fill: #64748b; -fx-font-weight: 500;"/>
                    <Label fx:id="lblTotalUsuarios" 
                           text="0" 
                           style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #2563eb;"/>
                </HBox>
            </HBox>

        </VBox>
    </center>

</BorderPane>